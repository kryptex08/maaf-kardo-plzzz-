<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Heartfelt Apology</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* 1. Base Document Background and Text */
        body {
            /* Deep, dark background representing emotional weight */
            background: linear-gradient(135deg, #101010 0%, #222222 100%);
            color: #d0d0d0;
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 2. Header Styles (Intense Guilt/Emotion) */
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(to right, #6d0000, #3a0000);
            border-radius: 10px;
            margin-bottom: 40px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            position: relative;
            overflow: hidden;
            border: 1px solid #440000;
        }

        header h1 {
            font-size: 3.2rem;
            margin-bottom: 15px;
            color: white;
            text-shadow: 1px 1px 10px rgba(255, 0, 0, 0.5);
            position: relative;
            z-index: 2;
        }

        header p {
            font-size: 1.4rem;
            color: #ffcccc;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .heart-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            z-index: 1;
        }

        .heart-bg i {
            position: absolute;
            color: #cc0000;
            animation: float 6s infinite ease-in-out;
        }

        /* 3. Main Content Sections */
        .apology-section,
        .memories-section,
        .regret-section,
        .promise-section {
            background-color: #1a1a1a;
            border-radius: 10px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }

        .section-title {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: #ff4444;
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
            text-transform: uppercase;
            font-weight: 700;
        }

        .section-title:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 10%;
            width: 80%;
            height: 3px;
            background: linear-gradient(to right, transparent, #ff4444, transparent);
        }

        .message-box {
            background-color: #2b2b2b;
            border-left: 5px solid #cc0000;
            padding: 25px;
            margin: 25px 0;
            border-radius: 5px;
            font-size: 1.2rem;
            line-height: 1.8;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            color: #e0e0e0;
            font-style: italic;
        }

        .highlight {
            color: #ff4444;
            font-weight: bold;
        }

        /* 4. Memories Gallery */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .memory-card {
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.4s, box-shadow 0.4s;
            cursor: pointer;
            position: relative;
            border: 1px solid #444;
        }

        .memory-card:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 25px rgba(255, 68, 68, 0.3);
        }

        .memory-img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            display: block;
        }

        .memory-caption {
            padding: 20px;
            background-color: #2b2b2b;
            color: #ccc;
        }

        .memory-caption h3 {
            margin-bottom: 10px;
            color: #ff7777;
        }

        /* 5. Regret Section */
        .regret-list {
            list-style-type: none;
            max-width: 800px;
            margin: 30px auto;
        }

        .regret-list li {
            padding: 15px 20px;
            margin-bottom: 15px;
            background-color: #101010;
            border-radius: 5px;
            border-left: 4px solid #cc0000;
            display: flex;
            align-items: center;
            transition: transform 0.3s;
            color: #d0d0d0;
        }

        .regret-list li:hover {
            transform: translateX(5px);
            background-color: #222;
        }

        .regret-list i {
            color: #ff4444;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        /* 6. Promise Section */
        .promise-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
            margin-top: 30px;
        }

        .promise-card {
            background: linear-gradient(135deg, #444 0%, #333 100%);
            color: white;
            padding: 25px;
            border-radius: 5px;
            width: 280px;
            text-align: center;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.4s;
            border-bottom: 5px solid #ff4444;
        }

        .promise-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(255, 68, 68, 0.3);
        }

        .promise-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #ff4444;
        }

        .promise-card h3 {
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        /* 7. Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(to right, #6d0000, #3a0000);
            border-radius: 10px;
            color: white;
            margin-bottom: 30px;
            box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.7);
        }

        .love-btn {
            background-color: #101010;
            color: #ff4444;
            border: 2px solid #ff4444;
            padding: 18px 45px;
            font-size: 1.3rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 20px 0;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            text-transform: uppercase;
        }

        .love-btn:hover {
            background-color: #333;
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255, 68, 68, 0.5);
        }

        .footer-text {
            margin-top: 20px;
            font-size: 1.2rem;
        }

        /* 8. Animations & Modals */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            max-width: 90%;
            max-height: 90%;
            border-radius: 5px;
            border: 3px solid #ff4444;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 30px;
            color: #ff4444;
            font-size: 40px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: white;
        }

        /* 9. Responsive Design (Kept from original) */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2.5rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .apology-section,
            .memories-section,
            .regret-section,
            .promise-section,
            footer {
                padding: 30px 20px;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 2rem;
            }

            header p {
                font-size: 1.1rem;
            }

            .gallery {
                grid-template-columns: 1fr;
            }
        }

        /* 10. Music Player Styles (Darkened) */
        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 5px;
            padding: 12px 20px;
            box-shadow: 0 5px 15px rgba(255, 68, 68, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            border: 1px solid #444;
        }

        .music-player:hover {
            box-shadow: 0 8px 25px rgba(255, 68, 68, 0.4);
            transform: translateY(-3px);
        }

        .music-btn {
            background-color: #cc0000;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.3rem;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
        }

        .music-btn:hover {
            background-color: #ff4444;
            transform: scale(1.1);
        }

        .volume-control {
            width: 100px;
            height: 6px;
            background-color: #333;
            border-radius: 3px;
            position: relative;
            cursor: pointer;
        }

        .volume-level {
            position: absolute;
            height: 100%;
            width: 70%;
            background-color: #ff4444;
            border-radius: 3px;
        }

        .volume-handle {
            position: absolute;
            width: 18px;
            height: 18px;
            background-color: #ff4444;
            border-radius: 50%;
            top: 50%;
            right: 0;
            transform: translate(50%, -50%);
            box-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
        }

        .music-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .music-title {
            font-weight: 600;
            color: #d0d0d0;
            font-size: 0.9rem;
        }

        .music-status {
            font-size: 0.8rem;
            color: #888;
        }

        /* Mobile responsive for music player (Kept from original) */
        @media (max-width: 768px) {
            .music-player {
                bottom: 10px;
                right: 10px;
                padding: 10px 15px;
            }

            .music-btn {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            .volume-control {
                width: 80px;
            }
        }

        @media (max-width: 480px) {
            .music-player {
                flex-direction: column;
                align-items: center;
                width: 60px;
                height: 60px;
                padding: 10px;
                overflow: hidden;
                transition: width 0.3s, height 0.3s;
            }

            .music-player:hover,
            .music-player.expanded {
                width: 180px;
                height: auto;
                border-radius: 10px;
            }

            .music-info,
            .volume-control {
                display: none;
            }

            .music-player:hover .music-info,
            .music-player.expanded .music-info,
            .music-player:hover .volume-control,
            .music-player.expanded .volume-control {
                display: flex;
            }

            .music-player:hover .music-info,
            .music-player.expanded .music-info {
                margin-top: 10px;
            }
        }

        /* 11. Heart Animation Styles (Darkened) */
        .heart-trail {
            position: absolute;
            width: 20px;
            height: 20px;
            pointer-events: none;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s;
            color: #ff4444;
            font-size: 20px;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.8);
            animation: heartFloat 1.5s ease-in forwards;
        }

        @keyframes heartFloat {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }

            50% {
                opacity: 0.8;
                transform: translate(0, -30px) scale(1.2) rotate(10deg);
            }

            100% {
                opacity: 0;
                transform: translate(0, -60px) scale(0.8) rotate(20deg);
            }
        }

        .floating-heart {
            position: fixed;
            color: rgba(255, 68, 68, 0.4);
            font-size: 20px;
            z-index: 9998;
            pointer-events: none;
            animation: floatingHeart linear infinite;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.2);
        }

        @keyframes floatingHeart {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .heart-pulse {
            position: absolute;
            width: 40px;
            height: 40px;
            /* Using SVG data URL for the heart icon */
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff4444"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') no-repeat center;
            background-size: contain;
            pointer-events: none;
            z-index: 9997;
            opacity: 0;
            animation: pulse 2s ease-out forwards;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.5);
                opacity: 0.8;
            }

            50% {
                opacity: 0.4;
            }

            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .click-heart {
            position: absolute;
            cursor: pointer;
            color: #ff4444;
            font-size: 24px;
            transition: all 0.3s;
            z-index: 9999;
            opacity: 0.6;
            animation: gentleBob 3s infinite ease-in-out;
        }

        @keyframes gentleBob {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-10px) rotate(5deg);
            }
        }

        .click-heart:hover {
            opacity: 1;
            transform: scale(1.5) rotate(15deg);
            color: #ff0000;
        }

        .heart-rain {
            position: fixed;
            top: -50px;
            color: #ff4444;
            font-size: 20px;
            z-index: 9996;
            pointer-events: none;
            animation: heartRain linear forwards;
        }

        @keyframes heartRain {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <div class="heart-bg" id="heartBackground"></div>
            <h1>My Heartfelt Apology</h1>
            <p>Every word I said that hurt you fills me with regret. Please give me a chance to make things right.</p>
        </header>

        <div class="music-player" id="musicPlayer">
            <button class="music-btn" id="musicToggle">
                <i class="fas fa-play" id="musicIcon"></i>
            </button>
            <div class="music-info">
                <div class="music-title">Our Song - Love Theme</div>
                <div class="music-status" id="musicStatus">Click to play</div>
            </div>
            <div class="volume-control" id="volumeControl">
                <div class="volume-level" id="volumeLevel"></div>
                <div class="volume-handle" id="volumeHandle"></div>
            </div>
            <audio id="backgroundMusic" loop>
                <source src="perfect.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>

        <div id="heartAnimations"></div>

        <section class="apology-section">
            <h2 class="section-title">I'm So Sorry</h2>
            <div class="message-box">
                <p>I am sorry Jheel merko pata haii ki in recent months me maii kbhi dhang se baat nhi kiyaa. Chid chid
                    hojata tha pehle jaise nhi interest show kiya.Baat pr gussa hojata tha tumhare and care kam krdiyaa
                    pr deep down
                    i still feel the same. Mere mu se us din galti se me bilkul nhi chahta tha ye shabd nhi bolu gusse
                    me pata nhi kya kya bolgaya bhut zyada sorry uske liye bhut zyada ðŸ˜­
                    I never once meant to breakup with you kbhi bhiii aaj itne time baad dukh hota hai..</p>

                <p>Jabse ye sab bola hai mu se nikli meri baatein tb se soch rha huu, ro rha hu tention m hu ki kaise
                    yaar nhi yr khatam nhi ho sakta nhi krna merko.
                    kyu lad leta sort nhi karta huu bhaii choti si baat thi m kbhi nhi krta aaj sb sahi rehta apne beech
                    me.
                    I am really sorry.
                </p>

                <p>Har ek pal without u feel so empty for me har ek second tumhare bina soche nhi reh pata but fir still
                    vahii regrett and guilt hota tumhe ye sab bolne ka.
                    Subah se msg krna chah rha huu pr dil ghabra raha tha tumse baat krne me ki kahi tum naraz ho still
                    aur firse kuch na hojaye isliye ye website bana rha hu
                    akhir ek coder apni feelings kaise bataye ðŸ˜­.
                </p>

                <p>Ye hamesha yaad rkhna plzz ki mera pyaar mere gusse aur sbse bhut upar hai mai boldeta hu bhut regret
                    karta hu pr i just want me sb kuch theek krdu aur vapis sab badiya hojaye apne beeech ðŸ’–
                    I love youu now and forever Jheel my cutuuu sorry baat nhi krne bs me dara hu tha aur koi baat niii
                    haii krna chahta hu still tumse baatein tumhe pyaar.
                    Tumse baat kiye bina 5,6,7 din bhaii me ek din nhi reh pa rha huu bilkul bhiii itna pyaar h tumsee.
                    I promise to be more good aur tumko aur pyar and care karu aise kbhi na karuuu i lovee youuuðŸ’–ðŸ¥¹
                    I hope you can forgive me darlingg ðŸ˜­
                </p>
            </div>
        </section>

        <section class="memories-section">
            <h2 class="section-title">Our Beautiful Memories</h2>
            <p style="text-align: center; margin-bottom: 20px;">These moments remind me why we're meant to be together.
            </p>

            <div class="gallery">
                <div class="memory-card" onclick="openModal('1.JPG', 'Our First Date')">
                    <img src="1.JPG" alt="First date memory" class="memory-img">
                    <div class="memory-caption">
                        <h3>Our First Date</h3>
                        <p>I was so nervous, but you made everything feel right.</p>
                    </div>
                </div>

                <div class="memory-card" onclick="openModal('2.JPG', 'First Time Bowling')">
                    <img src="2.JPG" alt="Bowling" class="memory-img">
                    <div class="memory-caption">
                        <h3>First Time bowling</h3>
                        <p>That magical afternoon enjoying bowling.</p>
                    </div>
                </div>

                <div class="memory-card" onclick="openModal('3 (2).JPG', 'Anniversary Dinner')">
                    <img src="3 (2).JPG" alt="Celebrating your birthday" class="memory-img">
                    <div class="memory-caption">
                        <h3>Anniversary Dinner</h3>
                        <p>Celebrating your first bday together.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="regret-section">
            <h2 class="section-title">What I Regret</h2>
            <p style="text-align: center; margin-bottom: 20px;">These are the things that keep me up at night, knowing I
                hurt you.</p>

            <ul class="regret-list">
                <li><i class="fas fa-heart-broken"></i> Raising my voice when you deserved my calmness</li>
                <li><i class="fas fa-heart-broken"></i> Talking about breaking up instead of working through our issues
                </li>
                <li><i class="fas fa-heart-broken"></i> Saying things in anger that I didn't mean</li>
                <li><i class="fas fa-heart-broken"></i> Not considering how my words would affect you</li>
                <li><i class="fas fa-heart-broken"></i> Letting frustration cloud my judgment about what truly matters -
                    us</li>
                <li><i class="fas fa-heart-broken"></i> Not appreciating in that moment how lucky I am to have you</li>
            </ul>
        </section>

        <section class="promise-section">
            <h2 class="section-title">My Promises to You</h2>
            <p style="text-align: center; margin-bottom: 20px;">I commit to doing better and being the partner you
                deserve.</p>

            <div class="promise-container">
                <div class="promise-card">
                    <i class="fas fa-comments"></i>
                    <h3>Better Communication</h3>
                    <p>I will express my feelings calmly and respectfully, without raising my voice.</p>
                </div>

                <div class="promise-card">
                    <i class="fas fa-heart"></i>
                    <h3>Unconditional Support</h3>
                    <p>I will always be your biggest supporter and your safe place.</p>
                </div>

                <div class="promise-card">
                    <i class="fas fa-hand-holding-heart"></i>
                    <h3>Patience & Understanding</h3>
                    <p>I will listen first, understand your perspective, and be patient.</p>
                </div>

                <div class="promise-card">
                    <i class="fas fa-user-clock"></i>
                    <h3>Quality Time</h3>
                    <p>I will prioritize our relationship and create more beautiful memories together.</p>
                </div>
            </div>
        </section>

        <footer>
            <h2 style="font-size: 2.5rem; margin-bottom: 20px;">I Love You</h2>
            <p style="font-size: 1.3rem; max-width: 800px; margin: 0 auto 30px;">
                You mean everything to me. Please forgive my mistakes and give our love another chance.
            </p>
            <button class="love-btn" id="loveButton">
                <i class="fas fa-heart"></i> Click if you believe in second chances
            </button>
            <p class="footer-text">With all my love and regret,</p>
            <p class="footer-text" style="font-weight: bold; font-size: 1.4rem;">Adiiii</p>
        </footer>
    </div>

    <div class="modal" id="imageModal">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage" src="" alt="Enlarged memory image">
    </div>

    <script>
        // --- Core Functions ---

        // Open image modal (Updated to take src and alt directly)
        function openModal(imgSrc, imgAlt) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');

            modalImg.src = imgSrc;
            modalImg.alt = imgAlt;
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Close image modal
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Love button interaction
        function setupLoveButton() {
            const loveButton = document.getElementById('loveButton');
            let clickCount = 0;

            loveButton.addEventListener('click', function () {
                clickCount++;

                if (clickCount === 1) {
                    loveButton.innerHTML = '<i class="fas fa-heart"></i> Thank you for considering it';
                    loveButton.style.backgroundColor = '#ffeff7';
                } else if (clickCount === 2) {
                    loveButton.innerHTML = '<i class="fas fa-heart"></i> You mean the world to me';
                    loveButton.style.backgroundColor = '#ffd9e8';
                } else if (clickCount === 3) {
                    loveButton.innerHTML = '<i class="fas fa-heart"></i> I promise to do better';
                    loveButton.style.backgroundColor = '#ffc2dd';
                } else if (clickCount === 4) {
                    loveButton.innerHTML = '<i class="fas fa-heart"></i> I love you more than anything';
                    loveButton.style.backgroundColor = '#ff65a3';
                    loveButton.style.color = 'white';
                    loveButton.disabled = true;

                    // Trigger a big heart rain effect on final click
                    createHeartRain(8000);

                    // Show a message
                    setTimeout(() => {
                        alert("Thank you for giving us another chance. I will cherish you and our relationship forever.");
                    }, 500);
                }
            });
        }


        // --- Heart Animations Functions ---

        // Create heart trail on cursor movement
        function createHeartTrail(x, y) {
            const heartAnimations = document.getElementById('heartAnimations');
            const heart = document.createElement('div');
            heart.className = 'heart-trail';
            heart.innerHTML = 'â¤ï¸';
            heart.style.left = `${x - 10}px`;
            heart.style.top = `${y - 10}px`;

            const size = 15 + Math.random() * 15;
            heart.style.fontSize = `${size}px`;
            const hue = 330 + Math.random() * 30;
            heart.style.color = `hsl(${hue}, 100%, 65%)`;

            heartAnimations.appendChild(heart);
            setTimeout(() => {
                if (heart.parentNode) {
                    heart.parentNode.removeChild(heart);
                }
            }, 1500);
        }

        // Create random floating hearts (page-wide)
        function createRandomHearts() {
            const heartAnimations = document.getElementById('heartAnimations');
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = 'â¤ï¸';
                const left = Math.random() * 100;
                heart.style.left = `${left}%`;
                const duration = 10 + Math.random() * 10;
                heart.style.animationDuration = `${duration}s`;
                const delay = Math.random() * 15;
                heart.style.animationDelay = `${delay}s`;
                const size = 15 + Math.random() * 25;
                heart.style.fontSize = `${size}px`;
                const opacity = 0.3 + Math.random() * 0.5;
                heart.style.opacity = opacity;
                heartAnimations.appendChild(heart);
            }
        }

        // Create clickable hearts within sections
        function createClickableHearts() {
            const sections = [
                '.apology-section',
                '.memories-section',
                '.regret-section',
                '.promise-section',
                'footer'
            ];

            sections.forEach(section => {
                const element = document.querySelector(section);
                if (element) {
                    const rect = element.getBoundingClientRect();
                    const heartCount = 2 + Math.floor(Math.random() * 2);

                    for (let i = 0; i < heartCount; i++) {
                        const heart = document.createElement('div');
                        heart.className = 'click-heart';
                        heart.innerHTML = 'â¤ï¸';
                        heart.style.position = 'absolute';

                        const left = 20 + Math.random() * (rect.width - 40);
                        const top = 20 + Math.random() * (rect.height - 40);

                        heart.style.left = `${left}px`;
                        heart.style.top = `${top}px`;
                        heart.style.animationDelay = `${Math.random() * 3}s`;

                        // Click event
                        heart.addEventListener('click', function () {
                            // Use window scroll position + element position for correct absolute coordinate
                            const clickX = rect.left + left + window.scrollX;
                            const clickY = rect.top + top + window.scrollY;
                            createHeartExplosion(clickX, clickY);

                            this.style.animation = 'none';
                            this.style.transform = 'scale(2)';
                            this.style.opacity = '0';

                            setTimeout(() => {
                                if (this.parentNode) {
                                    this.parentNode.removeChild(this);
                                }
                            }, 300);
                        });

                        // Set section to relative if not already
                        if (getComputedStyle(element).position === 'static') {
                            element.style.position = 'relative';
                        }
                        element.appendChild(heart);
                    }
                }
            });
        }

        // Create heart explosion effect
        function createHeartExplosion(x, y) {
            const heartAnimations = document.getElementById('heartAnimations');
            const heartCount = 12;

            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart-pulse';

                // Adjust for scroll position
                heart.style.left = `${x - window.scrollX}px`;
                heart.style.top = `${y - window.scrollY}px`;

                // NOTE: CSS variables like --tx/--ty were not defined in the CSS provided,
                // so this effect relies purely on the 'pulse' animation in the provided CSS.

                heartAnimations.appendChild(heart);

                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, 2000);
            }
        }

        // Create heart rain effect
        function createHeartRain(duration = 5000) {
            const heartAnimations = document.getElementById('heartAnimations');
            const rainInterval = setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart-rain';
                heart.innerHTML = 'â¤ï¸';
                const left = Math.random() * window.innerWidth;
                heart.style.left = `${left}px`;
                const size = 15 + Math.random() * 25;
                heart.style.fontSize = `${size}px`;
                const hue = 320 + Math.random() * 40;
                heart.style.color = `hsl(${hue}, 100%, 65%)`;
                const fallDuration = 2 + Math.random() * 3;
                heart.style.animationDuration = `${fallDuration}s`;
                heartAnimations.appendChild(heart);

                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, fallDuration * 1000);
            }, 100);

            setTimeout(() => {
                clearInterval(rainInterval);
            }, duration);
        }

        // Create background floating hearts in the header
        function createFloatingHearts() {
            const heartBg = document.getElementById('heartBackground');
            const heartCount = 25;

            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('i');
                heart.className = 'fas fa-heart';
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.top = `${Math.random() * 100}%`;
                heart.style.fontSize = `${Math.random() * 20 + 15}px`;
                heart.style.animationDelay = `${Math.random() * 5}s`;
                heartBg.appendChild(heart);
            }
        }

        // Initialize all heart animations
        function initializeHeartAnimations() {
            createRandomHearts();
            createClickableHearts();
            createFloatingHearts(); // Ensure this is also called

            // Setup cursor trail
            document.addEventListener('mousemove', (e) => {
                const now = Date.now();
                // Only create hearts every ~100ms for performance
                if (now % 100 < 20) {
                    createHeartTrail(e.clientX, e.clientY);
                }
            });

            // Start gentle heart rain every 30 seconds
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% chance
                    createHeartRain(3000);
                }
            }, 30000);
        }

        // --- Music Player Functions ---

        function setupMusicPlayer() {
            const musicPlayer = document.getElementById('musicPlayer');
            const musicToggle = document.getElementById('musicToggle');
            const musicIcon = document.getElementById('musicIcon');
            const musicStatus = document.getElementById('musicStatus');
            const backgroundMusic = document.getElementById('backgroundMusic');
            const volumeControl = document.getElementById('volumeControl');
            const volumeLevel = document.getElementById('volumeLevel');
            const volumeHandle = document.getElementById('volumeHandle');

            // Set initial volume (70%)
            let currentVolume = 0.7;
            backgroundMusic.volume = currentVolume;
            volumeLevel.style.width = `${currentVolume * 100}%`;
            volumeHandle.style.right = `${(1 - currentVolume) * 100}%`; // Position handle correctly

            // Toggle play/pause
            musicToggle.addEventListener('click', function (e) {
                e.stopPropagation();

                if (backgroundMusic.paused) {
                    backgroundMusic.play()
                        .then(() => {
                            musicIcon.className = 'fas fa-pause';
                            musicStatus.textContent = 'Now playing';
                            musicPlayer.classList.add('playing');
                        })
                        .catch(error => {
                            console.error("Audio playback failed:", error);
                            musicStatus.textContent = 'Click to play';
                            // Alert is often blocked, but kept for user notification
                            alert("Please interact with the page first to enable audio.");
                        });
                } else {
                    backgroundMusic.pause();
                    musicIcon.className = 'fas fa-play';
                    musicStatus.textContent = 'Paused';
                    musicPlayer.classList.remove('playing');
                }
            });

            // Volume control logic
            let isDragging = false;

            function startDragging(e) {
                e.preventDefault();
                e.stopPropagation();
                isDragging = true;
                updateVolume(e);

                document.addEventListener('mousemove', updateVolume);
                document.addEventListener('touchmove', updateVolume, { passive: false });
                document.addEventListener('mouseup', stopDragging);
                document.addEventListener('touchend', stopDragging);
            }

            function updateVolume(e) {
                if (!isDragging) return;
                e.preventDefault(); // Prevent scrolling on mobile while adjusting volume

                const rect = volumeControl.getBoundingClientRect();
                let clientX;

                if (e.type.includes('touch')) {
                    clientX = e.touches[0].clientX;
                } else {
                    clientX = e.clientX;
                }

                let x = clientX - rect.left;
                x = Math.max(0, Math.min(x, rect.width));

                currentVolume = x / rect.width;
                backgroundMusic.volume = currentVolume;

                volumeLevel.style.width = `${currentVolume * 100}%`;
                // Handle position logic is (1 - currentVolume) * 100% since 'right' is used in CSS
                volumeHandle.style.right = `${(1 - currentVolume) * 100}%`;
            }

            function stopDragging() {
                isDragging = false;
                document.removeEventListener('mousemove', updateVolume);
                document.removeEventListener('touchmove', updateVolume);
                document.removeEventListener('mouseup', stopDragging);
                document.removeEventListener('touchend', stopDragging);
            }

            volumeControl.addEventListener('mousedown', startDragging);
            volumeControl.addEventListener('touchstart', startDragging, { passive: false });


            // Click anywhere on music player to expand on mobile
            musicPlayer.addEventListener('click', function (e) {
                if (window.innerWidth <= 480) {
                    musicPlayer.classList.toggle('expanded');
                }
            });

            // Auto-play music after user interaction with page
            let musicAutoPlayAttempted = false;
            function attemptMusicAutoPlay() {
                if (musicAutoPlayAttempted) return;

                musicAutoPlayAttempted = true;
                backgroundMusic.play()
                    .then(() => {
                        musicIcon.className = 'fas fa-pause';
                        musicStatus.textContent = 'Now playing';
                        musicPlayer.classList.add('playing');
                    })
                    .catch(error => {
                        console.log("Auto-play prevented. User needs to interact first.");
                    });
            }

            document.addEventListener('click', function firstInteraction() {
                setTimeout(attemptMusicAutoPlay, 500);
                document.removeEventListener('click', firstInteraction);
            }, { once: true });
        }


        // --- Initialization ---

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize all core functions
            initializeHeartAnimations();
            setupLoveButton();
            setupMusicPlayer();

            // Fix memory card click handlers (must be placed here as the original used hardcoded memory IDs)
            // The HTML was updated to pass the image src and alt directly to openModal.

            // Close modal when clicking outside the image
            const modal = document.getElementById('imageModal');
            modal.addEventListener('click', function (e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
        });
    </script>
</body>

</html>